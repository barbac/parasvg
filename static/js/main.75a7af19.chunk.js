(this.webpackJsonpparasvg=this.webpackJsonpparasvg||[]).push([[0],{54:function(e){e.exports=JSON.parse('{"guides":[{"direction":1,"label":"","length":0,"lengthExpresion":1562.5,"originIndex":null,"pos":573.462036132812,"type":"h"},{"direction":1,"label":"","length":0,"lengthExpresion":93.75,"originIndex":null,"pos":344.409515380859,"type":"v"},{"direction":1,"label":"","length":9.93,"lengthExpresion":9.93,"originIndex":null,"pos":373.615397733801,"type":"v"},{"direction":1,"label":"","length":31.31,"lengthExpresion":31.31,"originIndex":null,"pos":436.497750674977,"type":"v"},{"direction":1,"label":"middle","length":50.39,"lengthExpresion":50.39,"originIndex":null,"pos":492.615397733801,"type":"v"},{"direction":1,"label":"","length":80.31,"lengthExpresion":80.31,"originIndex":null,"pos":337.256153779871,"type":"h"},{"direction":1,"label":"","length":111.59,"lengthExpresion":111.59,"originIndex":null,"pos":245.256153779871,"type":"h"},{"direction":1,"label":"","length":121.99,"lengthExpresion":121.99,"originIndex":null,"pos":214.667918485754,"type":"h"},{"direction":1,"label":"","length":130.83,"lengthExpresion":130.83,"originIndex":null,"pos":188.667918485754,"type":"h"}],"mirror":true,"name":"tank top - front","parameters":[{"name":"body","parameters":{"Shoulder":20,"Waist":94}},{"name":"customization","parameters":{"Waist extra":1}}],"scale":0.34,"vertices":[{"anchorX":1,"anchorY":0,"type":"end","x":344.409515380859,"y":573.462036132812},{"anchorX":1,"anchorY":5,"type":"end","x":344.409515380859,"y":337.256153779871},{"anchorX":-1,"anchorY":null,"type":"control","x":405.478210449219,"y":326.493041992188},{"anchorX":2,"anchorY":7,"type":"end","x":373.615397733801,"y":214.667918485754},{"anchorX":3,"anchorY":8,"type":"end","x":436.497750674977,"y":188.667918485754},{"anchorX":-1,"anchorY":6,"type":"control","x":452.626861572266,"y":245.256153779871},{"anchorX":4,"anchorY":6,"type":"end","x":492.615397733801,"y":245.256153779871},{"anchorX":4,"anchorY":0,"type":"end","x":492.615397733801,"y":573.462036132812}]}')},55:function(e){e.exports=JSON.parse('{"guides":[{"direction":1,"label":"","length":0,"lengthExpresion":500,"originIndex":null,"pos":573.462036132812,"type":"h"},{"direction":1,"label":"","length":0,"lengthExpresion":30,"originIndex":null,"pos":13.9200716018677,"type":"v"},{"direction":1,"label":"","length":8.32,"lengthExpresion":8.32,"originIndex":null,"pos":39.9200716018677,"type":"v"},{"direction":1,"label":"","length":28.48,"lengthExpresion":28.48,"originIndex":null,"pos":102.920071601868,"type":"v"},{"direction":1,"label":"","length":64.96,"lengthExpresion":64.96,"originIndex":null,"pos":216.920071601868,"type":"v"},{"direction":1,"label":"","length":84.8,"lengthExpresion":84.8,"originIndex":null,"pos":278.920071601868,"type":"v"},{"direction":1,"label":"waist","length":94,"lengthExpresion":"Waist","originIndex":null,"pos":307.670071601868,"type":"v"},{"direction":1,"label":"","length":75.84,"lengthExpresion":75.84,"originIndex":null,"pos":336.462036132812,"type":"h"},{"direction":1,"label":"","length":114.24,"lengthExpresion":114.24,"originIndex":null,"pos":216.462036132812,"type":"h"},{"direction":1,"label":"","length":122.88,"lengthExpresion":122.88,"originIndex":null,"pos":189.462036132812,"type":"h"}],"mirror":false,"name":"tank top - back","parameters":[{"name":"body","parameters":{"Shoulder":20,"Waist":94}},{"name":"customization","parameters":{"Waist extra":1}}],"scale":0.32,"vertices":[{"anchorX":1,"anchorY":0,"type":"end","x":13.9200716018677,"y":573.462036132812},{"anchorX":1,"anchorY":7,"type":"end","x":13.9200716018677,"y":336.462036132812},{"anchorX":-1,"anchorY":7,"type":"control","x":76.3358764648438,"y":336.462036132812},{"anchorX":2,"anchorY":8,"type":"end","x":39.9200716018677,"y":216.462036132812},{"anchorX":3,"anchorY":9,"type":"end","x":102.920071601868,"y":189.462036132812},{"anchorX":-1,"anchorY":8,"type":"control","x":163.448593139648,"y":216.462036132812},{"anchorX":4,"anchorY":9,"type":"end","x":216.920071601868,"y":189.462036132812},{"anchorX":5,"anchorY":8,"type":"end","x":278.920071601868,"y":216.462036132812},{"anchorX":-1,"anchorY":7,"type":"control","x":243.825775146484,"y":336.462036132812},{"anchorX":6,"anchorY":7,"type":"end","x":307.670074462891,"y":336.462036132812},{"anchorX":6,"anchorY":0,"type":"end","x":307.670074462891,"y":573.462036132812}]}')},62:function(e,t,n){},63:function(e,t,n){},79:function(e,t){},87:function(e,t,n){"use strict";n.r(t);var o=n(7),r=n.n(o),a=n(37),c=n(34),i=n(47),l=n(35);c.a.use(i.a).use(l.e).init({resources:{en:{translation:{"New pattern":"New pattern",Patterns:"Patterns","New name":"New name",Save:"save","Background image url":"Background image url","Background image":"Background image",Scale:"Scale",Guides:"Guides",gcode:"gcode",Generate:"Generate",Move:"Move","Vertical guide":"Vertical guide","Horizontal guide":"Horizontal guide","Add vertex":"Add vertex","Convert to curve":"convert to curve",Mirror:"Mirror",Undo:"Undo",Redo:"Redo"}},es:{translation:{"New pattern":"Nuevo patr\xf3n",Patterns:"Patrones","New name":"Nuevo nombre",Save:"Guardar","Background image url":"url para imagen de fondo","Background image":"Imagen de fondo",Scale:"Escala",Guides:"Gu\xedas",gcode:"gcode",Generate:"Generar",Move:"Mover","Vertical guide":"Gu\xeda vertical","Horizontal guide":"Gu\xeda horizontal","Add vertex":"Agregar v\xe9rtice","Convert to curve":"Convertir a curva",Mirror:"Reflejar",Undo:"Deshacer",Redo:"Rehacer"}}},interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator","htmlTag"]}});n(62),n(63);var s=n(12),u=n(10),d=n(11),h=n(5);function p(e){var t=e.vertices,n=e.onMouseDown,o=e.onClick;return Object(h.jsx)(h.Fragment,{children:t.map((function(e,t){var r=e.x,a=e.y,c=e.type;return Object(h.jsxs)("g",{className:"handle",onMouseDown:function(){return n(t)},onClick:function(){return o(t)},children:[Object(h.jsx)("circle",{cx:r,cy:a,className:"".concat(t?c:"start"),r:8}),Object(h.jsx)("text",{x:r-4,y:a+4,children:t})]},t)}))})}var g=n(33),x=function(){return Object(g.b)()},j=g.c,v=n(91),b=n(90),f=n(30),y=Object(v.a)(b.a),O={name:"",scale:1,mirror:!1,vertices:[],guides:[{type:"h",originIndex:null,pos:500,length:500,lengthExpresion:500,direction:1,label:""},{type:"v",originIndex:null,pos:30,length:30,lengthExpresion:30,direction:1,label:""}],parameters:[{name:"body",parameters:{Waist:94,Shoulder:20}},{name:"customization",parameters:{"Waist extra":1}}]};function m(e,t,n){var o=0;if(e.type===F){o=(t[0].pos-e.pos)*n}else{var r=t[1];o=(e.pos-r.pos)*n}return o=Math.round(100*o)/100}function M(e,t,n){e.forEach((function(e){t.type===F&&e.anchorY===n?e.y=t.pos:t.type===J&&e.anchorX===n&&(e.x=t.pos)}))}function C(e,t,n){if(!(t<2)){var o=n.guides[t];o.lengthExpresion=e;var r=0;try{var a={};n.parameters.forEach((function(e){for(var t in e.parameters)a[t]=e.parameters[t]})),n.guides.forEach((function(e){e.label&&(a[e.label]=e.length)})),r=y.evaluate("".concat(e),a)}catch(l){return void console.log(l)}if("number"===typeof r){if(o.length=r,o.type===F){var c=n.guides[0];o.pos=c.pos-o.length/n.scale}else{var i=n.guides[1];o.pos=i.pos+o.length/n.scale}M(n.vertices,o,t)}}}var w=Object(f.b)({name:"pattern",initialState:O,reducers:{setPattern:function(e,t){console.log("loading state");var n=t.payload,o=n.name,r=n.scale,a=n.mirror,c=n.vertices,i=n.guides,l=n.parameters;e.name=o,e.scale=r,e.mirror=a,e.vertices=c,e.guides=i,e.parameters=l},setName:function(e,t){e.name=t.payload},setScale:function(e,t){var n=e.scale;e.scale=t.payload;var o=e.scale/n;e.guides.forEach((function(t,n){var r=t.length;t.length*=o,t.length=Math.round(100*t.length)/100,t.lengthExpresion===r&&(t.lengthExpresion=t.length),e.guides.forEach((function(t,n){C(t.lengthExpresion,n,e)}))}))},setMirror:function(e,t){e.mirror=t.payload},toggleMirror:function(e,t){e.mirror=!e.mirror},clearVertices:function(e,t){e.vertices=[]},setVertices:function(e,t){e.vertices=t.payload},addVertex:function(e,t){e.vertices.push(t.payload)},setVertexValue:function(e,t){e.vertices[t.payload.index]=t.payload.vertex},clearGuides:function(e,t){e.guides=Object(u.a)(O.guides)},addGuide:function(e,t){var n=e.guides.push(t.payload)-1,o=e.guides[n];o.length=m(o,e.guides,e.scale),o.lengthExpresion=o.length},setGuideLabel:function(e,t){e.guides[t.payload.index].label=t.payload.label},setGuidePos:function(e,t){var n=t.payload.index,o=e.guides[n],r=t.payload,a=r.x,c=r.y;if(o.pos=o.type===F?c:a,n<2){o.length=0;for(var i=2,l=e.guides.length;i<l;i++){var s=e.guides[i];s.type===o.type&&(s.length===s.lengthExpresion?(s.length=m(s,e.guides,e.scale),s.lengthExpresion=s.length):C(s.lengthExpresion,i,e))}}else o.length=m(o,e.guides,e.scale),o.lengthExpresion=o.length;M(e.vertices,o,n)},setGuideLength:function(e,t){var n=t.payload.index;C(t.payload.length,n,e)},setParameterValue:function(e,t){e.parameters[t.payload.index].parameters[t.payload.name]=t.payload.value,e.guides.forEach((function(t,n){C(t.lengthExpresion,n,e)}))},finishDragging:function(e,t){}}}),k=w.actions,E=k.setName,S=k.setScale,N=(k.setMirror,k.toggleMirror),G=k.clearVertices,I=k.setVertices,X=k.addVertex,Y=k.setVertexValue,P=k.clearGuides,V=k.addGuide,A=k.setGuideLabel,L=k.setGuidePos,B=k.setGuideLength,T=k.setParameterValue,K=k.finishDragging,R=function(e){return e.pattern.present},D=function(e){return e.pattern.present.mirror},W=function(e){return e.pattern.present.vertices},z=function(e){return e.pattern.present.guides},H=function(e){return e.pattern.present.parameters},U=w.reducer,F="h",J="v";function Z(e){var t=e.width,n=e.height,o=e.onMouseDown,r=j(z);return Object(h.jsx)(h.Fragment,{children:r.map((function(e,r){var a=e.pos,c={};return c=e.type===F?{x1:0,x2:t,y1:a,y2:a}:{x1:a,x2:a,y1:0,y2:n},Object(h.jsxs)("g",{className:"guide",onMouseDown:function(){return o(r)},children:[Object(h.jsx)("line",Object(s.a)(Object(s.a)({},c),{},{className:"hover"})),Object(h.jsx)("line",Object(s.a)({},c))]},r)}))})}var Q=n(92);function $(e){var t=e.x,n=e.y,r=e.index,a=(e.firstPoint,e.scale,e.children),c=Object(Q.a)().t,i=Object(o.useState)(!1),l=Object(d.a)(i,2),s=l[0],u=l[1],p=x(),g=j(z)[r];return Object(h.jsxs)("g",{className:"measurement",onClick:function(){return u(!s)},children:[a,s?Object(h.jsx)("foreignObject",{width:"150",height:"1.5em",x:t-150,y:n-20,children:Object(h.jsx)("input",{onClick:function(e){return e.stopPropagation()},type:"text",value:g.label,placeholder:c("label"),onChange:function(e){return p(A({label:e.target.value,index:r}))}})}):Object(h.jsx)("text",{x:t,y:n,children:g.label}),s&&Object(h.jsx)("foreignObject",{width:"100",height:"1.5em",x:t+20,y:n-20,children:Object(h.jsx)("input",{onClick:function(e){return e.stopPropagation()},type:"text",placeholder:c("value"),value:g.lengthExpresion,onChange:function(e){var t=e.target.value;p(B({length:t,index:r}))}})})]})}function q(e){var t=e.width,n=e.height,o=e.scale,r=j(z),a=[],c=[];r.forEach((function(e,t){var n=e.pos,o=e.length;e.type===F?a.push([n,o,t]):c.push([n,o,t])}));var i=a.length?a.shift()[0]:0,l=c.length?c.shift()[0]:0;return Object(h.jsxs)(h.Fragment,{children:[a.map((function(e,n){var r=Object(d.a)(e,3),c=r[0],u=r[1],p=r[2],g=Math.abs(c-i),x=t/(a.length+1)*(n+1),j=i-g/2,v={x1:x,x2:x,y1:c,y2:i};return Object(h.jsxs)($,{x:x,y:j-5,index:p,firstPoint:l,scale:o,children:[Object(h.jsx)("line",Object(s.a)({},v)),Object(h.jsx)("polyline",{points:"".concat(x,",").concat(c," ").concat(x+3,",").concat(c+3," ").concat(x-3,",").concat(c+3," ").concat(x,",").concat(c)}),Object(h.jsx)("polyline",{points:"".concat(x,",").concat(i," ").concat(x+3,",").concat(i-3," ").concat(x-3,",").concat(i-3," ").concat(x,",").concat(i)}),Object(h.jsx)("text",{x:x,y:j+15,children:u})]},n+"v")})),c.map((function(e,t){var r=Object(d.a)(e,3),a=r[0],i=r[1],u=r[2],p=Math.abs(a-l),g=n/(c.length+1)*(t+1),x=l+p/2,j={x1:l,x2:a,y1:g,y2:g};return Object(h.jsxs)($,{x:x,y:g-5,index:u,firstPoint:l,scale:o,children:[Object(h.jsx)("line",Object(s.a)({},j)),Object(h.jsx)("polyline",{points:"".concat(l,",").concat(g," ").concat(l+3,",").concat(g+3," ").concat(l+3,",").concat(g-3," ").concat(l,",").concat(g)}),Object(h.jsx)("polyline",{points:"".concat(a,",").concat(g," ").concat(a-3,",").concat(g-3," ").concat(a-3,",").concat(g+3," ").concat(a,",").concat(g)}),Object(h.jsx)("text",{y:g+15,x:x,children:i})]},t+"v")}))]})}function _(e){if(e.length<3)return e;var t=e.length-1,n=[];e.forEach((function(e,o){o!==t&&n.push(e)}));for(var o=2*e[t].x,r=t;r>=0;r--){var a=e[r],c=Object(s.a)({},a);c.x=o-a.x,n.push(c)}return n}var ee=_;function te(e){var t=e.vertices,n=e.mirror;if(!t.length)return null;t=n?_(t):t;var o=!1,r=t.map((function(e,t){var n=e.x,r=e.y;return"control"===e.type?(o=!0,"Q ".concat(n,",").concat(r)):o?(o=!1," ".concat(n,", ").concat(r)):"L ".concat(n,", ").concat(r)})),a="M ".concat(t[0].x,", ").concat(t[0].y,"\n")+r.join("\n")+" Z";return Object(h.jsx)("path",{className:"path",d:a,stroke:"LightSkyBlue",strokeWidth:"1",strokeOpacity:"1",opacity:"1",fillOpacity:"0"})}var ne=n(56);var oe=Object(f.b)({name:"tools",initialState:{toolMode:"move"},reducers:{selectToolMode:function(e,t){e.toolMode=t.payload},setToolState:function(e,t){e.toolMode=t.payload}}}),re=oe.actions.setToolState,ae=function(e){return e.toolbox.toolMode},ce=oe.reducer,ie=n(31),le=n.n(ie),se=Object(f.a)({reducer:{pattern:le()(U,{filter:Object(ie.excludeAction)(["pattern/setGuidePos","pattern/setVertexValue"])}),toolbox:ce}}),ue=n(54),de=n(55),he="PATTERN:";var pe={load:function(e){if(console.log("loading..."),"tank top - back - sample"!==e){if("tank top - front - sample"!==e){var t=window.localStorage.getItem(he+e);if(t){var n=JSON.parse(t);console.log(n),se.dispatch({type:"pattern/setPattern",payload:n})}else console.log("pattern: ".concat(e," not found"),e)}else se.dispatch({type:"pattern/setPattern",payload:de})}else se.dispatch({type:"pattern/setPattern",payload:ue})},save:function(){var e=se.getState().pattern.present;""!==e.name&&(console.log("saving",e),window.localStorage.setItem(he+e.name,JSON.stringify(e)))}};function ge(e){var t=e.onChange,n=Object(Q.a)().t;return Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:n("Background image")}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){var n=new FileReader,o=e.target.files[0];n.onload=function(e){return t(o.name,e.target.result)},n.readAsDataURL(e.target.files[0])}})})]})}var xe="screen and (max-device-width: 800px)";function je(e){var t=e.className,n=e.children,r=Object(o.useState)(!0),a=Object(d.a)(r,2),c=a[0],i=a[1],l=window.matchMedia(xe).matches;return Object(o.useLayoutEffect)((function(){window.matchMedia(xe).matches&&i(!1)}),[l]),Object(h.jsxs)("div",{className:t,children:[Object(h.jsx)("button",{className:"toggle-controls",onClick:function(e){return i(!c)},children:c?"-":"o"}),Object(h.jsx)("div",{style:{display:c?"":"none"},children:n})]})}function ve(){var e=j(H),t=x(),n=e.map((function(e,n){var o=e.name,r=e.parameters,a=[],c=function(e){a.push(Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:e}),Object(h.jsx)("input",{type:"number",value:r[e],onChange:function(o){var r=o.target.valueAsNumber;Number.isNaN(r)||t(T({index:n,name:e,value:r}))}})]},e))};for(var i in r)c(i);return Object(h.jsxs)("div",{children:[n&&Object(h.jsx)("div",{children:"---"}),Object(h.jsx)("div",{style:{marginBottom:10},children:o}),Object(h.jsx)(h.Fragment,{children:a})]},o)}));return Object(h.jsx)("div",{className:"parameters",children:n})}function be(e){e.image;var t=e.onBackgroundSelected,n=e.onNewAction,r=e.onSaveAction,a=e.onLoadAction,i=e.gcode,l=e.onGcodeAction,s=Object(Q.a)().t,p=x(),g=j(z).map((function(e,t){var n=e.lengthExpresion,o=e.label;return t<2?null:Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:o||t-1}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"text",value:n,onChange:function(e){var n={length:e.target.value,index:t};p(B(n))}})})]},t)})),v=Object(o.useState)(""),b=Object(d.a)(v,2),f=b[0],y=b[1],O=j(R),m="PATTERN:",M=[""].concat(Object(u.a)(Object.keys(window.localStorage).filter((function(e){return!e.indexOf(m)})).map((function(e){return e.replace(m,"")})))),C="tank top - back - sample";window.localStorage.getItem(C)||M.push(C);window.localStorage.getItem("tank top - front - sample")||M.push("tank top - front - sample");var w=M.map((function(e){return Object(h.jsx)("option",{value:e,children:e},e)}));return Object(h.jsx)(je,{className:"controls",children:Object(h.jsxs)("form",{children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{type:"button",value:"English",onClick:function(){return c.a.changeLanguage("en")}}),Object(h.jsx)("input",{type:"button",value:"Espa\xf1ol",onClick:function(){return c.a.changeLanguage("es")}})]}),Object(h.jsx)("div",{children:Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"button",value:s("New pattern"),onClick:function(){return n()}})})}),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:s("Patterns")}),Object(h.jsx)("div",{children:Object(h.jsx)("select",{onChange:function(e){return a(e.target.value)},children:w})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:s("New name")}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"text",value:O.name,onChange:function(e){return p(E(e.target.value))}})}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{value:s("Save"),type:"button",onClick:function(){return r()}})})]}),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:s("Background image url")}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"text",value:f,onChange:function(e){var n=e.target.value;y(n),t(n)}})})]}),Object(h.jsx)(ge,{onChange:function(e,n){y(e),t(n)}}),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:s("Scale")}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"number",value:O.scale,onChange:function(e){return p(S(e.target.valueAsNumber))}})})]}),Object(h.jsx)("div",{children:s("Parameters")}),Object(h.jsx)(ve,{}),Object(h.jsx)("div",{children:s("Guides")}),g,Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:s("gcode")}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"button",value:s("Generate"),onClick:function(){return l()}})}),Object(h.jsx)("textarea",{value:i,readOnly:!0,onClick:function(e){return e.target.select()}})]})]})})}var fe=n(57),ye=["path"],Oe=25;function me(e){var t=e.title,n=e.tool,o=e.toolMode,r=e.onClick,a=e.children;return Object(h.jsx)("button",{title:t,className:o===n?"active":"",onClick:function(){return r()},children:a})}function Me(e){var t=e.path,n=Object(fe.a)(e,ye);return Object(h.jsx)(me,Object(s.a)(Object(s.a)({},n),{},{children:Object(h.jsx)("svg",{width:Oe,height:Oe,children:Object(h.jsx)("path",{d:t,fillOpacity:"0%"})})}))}function Ce(){var e=x(),t=j(D),n=j(ae),o=Object(Q.a)().t;return Object(h.jsx)(je,{className:"toolbox",children:Object(h.jsxs)("div",{className:"tools",children:[Object(h.jsx)(me,{title:o("Move"),onClick:function(){return e(re("move"))},tool:"move",toolMode:n,children:Object(h.jsx)("svg",{viewBox:"0 0 320 512",width:"25",height:"25",children:Object(h.jsx)("path",{d:"M302.189 329.126H196.105l55.831 135.993c3.889 9.428-.555 19.999-9.444 23.999l-49.165 21.427c-9.165 4-19.443-.571-23.332-9.714l-53.053-129.136-86.664 89.138C18.729 472.71 0 463.554 0 447.977V18.299C0 1.899 19.921-6.096 30.277 5.443l284.412 292.542c11.472 11.179 3.007 31.141-12.5 31.141z"})})}),Object(h.jsx)(Me,{path:"M10,0 V20",tool:"vguide",toolMode:n,title:o("Vertical guide"),onClick:function(){return e(re("vguide"))}}),Object(h.jsx)(Me,{path:"M0,10 H20",tool:"hguide",toolMode:n,title:o("Horizontal guide"),onClick:function(){return e(re("hguide"))}}),Object(h.jsx)(me,{title:o("Add vertex"),onClick:function(){return e(re("handle"))},tool:"handle",toolMode:n,children:Object(h.jsx)("svg",{width:Oe,height:Oe,children:Object(h.jsx)("circle",{cx:12.5,cy:12.5,r:6.25,fill:"#000"})})}),Object(h.jsx)(Me,{title:o("Convert to curve"),onClick:function(){return e(re("curve"))},path:"M6,0 Q30,20 6,25",tool:"curve",toolMode:n}),Object(h.jsx)(Me,{title:o("Mirror"),onClick:function(){return e(N())},path:"M0,0 Q25,20 0,25 M25,0 Q0,20 25,25",tool:"mirror",toolMode:t?"mirror":""}),Object(h.jsx)(Me,{title:o("Undo"),onClick:function(){return e(ie.ActionCreators.undo())},path:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z",tool:"undo",toolMode:""}),Object(h.jsx)(Me,{title:o("Redo"),onClick:function(){return e(ie.ActionCreators.redo())},path:"M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z",tool:"redo",toolMode:""})]})})}var we="curve",ke={KeyN:"move",KeyP:"handle",KeyH:"hguide",KeyV:"vguide",KeyC:"clear",KeyS:we};function Ee(){var e,t=x(),n=j(R),r=j(z),a=j(W),c=j(ae),i=function(e){return t(re(e))},l=Object(o.useState)(null),g=Object(d.a)(l,2),v=g[0],b=g[1],f=Object(o.useState)(null),y=Object(d.a)(f,2),O=y[0],m=y[1],M=Object(o.useState)("pattern.png"),C=Object(d.a)(M,2),w=C[0],k=C[1],A=Object(o.useState)(""),B=Object(d.a)(A,2),T=B[0],D=B[1];function H(t,n){var o=e.createSVGPoint();o.x=t.clientX,o.y=t.clientY;var r=o.matrixTransform(e.getScreenCTM().inverse());return{type:n,originIndex:null,pos:n===F?r.y:r.x,length:0,lengthExpresion:0,direction:1,label:""}}function U(){D(function(e,t){if(!e.length)return"";t*=10;var n=e[0],o=e=e.map((function(e){var o=Object(s.a)({},e);return o.x=(e.x-n.x)*t,o.y=(e.y-n.y)*-t,o}));e=Object(u.a)(e),console.log("generating gcode");var r=e.shift();if(!r)return"";var a=[],c=null;return e.forEach((function(e,t){if(t+=1,"control"===e.type)return c=e,void a.push("(control ".concat(t,")"));c?(new ne.a(o[t-2].x,o[t-2].y,o[t-1].x,o[t-1].y,e.x,e.y).getLUT(30).forEach((function(e){a.push("G1 X".concat(e.x," Y").concat(e.y," (").concat(t," step)"))})),c=null):a.push("G1 X".concat(e.x," Y").concat(e.y," (").concat(t,")"))})),"G0 Z".concat(10,"\nG0 X").concat(r.x," Y").concat(r.y," (0)\nG1 Z").concat(-5," F").concat(2e3,"\n").concat(a.join("\n"),"\nG0 Z").concat(10,"\n  ")}(n.mirror?ee(a):a,n.scale))}var Q={move:function(){},handle:function(n){if(n.altKey)t(G());else{var o=e.createSVGPoint();o.x=n.clientX,o.y=n.clientY;var r=o.matrixTransform(e.getScreenCTM().inverse());t(X({anchorX:null,anchorY:null,x:r.x,y:r.y,type:"end"}))}},hguide:function(e){t(V(H(e,F)))},vguide:function(e){t(V(H(e,J)))}},$=1e3,_="0 0 ".concat($," ").concat(600);return Object(h.jsxs)("div",{className:"container",style:{border:"thin solid blue"},children:[Object(h.jsx)("div",{className:"controls",children:Object(h.jsx)(be,{image:w,onBackgroundSelected:k,onNewAction:function(){console.log("new, clearing."),t(G()),t(P()),i("move"),b(null),m(null),t(S(1)),t(E(""))},onSaveAction:function(){pe.save()},onLoadAction:function(e){""!==e?e!==n.name&&(pe.load(e),i("move"),b(null),m(null)):t(E(""))},gcode:T,onGcodeAction:U})}),Object(h.jsx)(Ce,{}),Object(h.jsxs)("svg",{id:"svg",ref:function(t){e=t},viewBox:_,className:"background-img",style:{border:"thin solid red",height:"100vh"},onClick:Q[c],onMouseUp:function(){b(null),m(null),t(K())},onMouseMove:function(n){if(null!==v||null!==O){var o=e.createSVGPoint();o.x=n.clientX,o.y=n.clientY;var c=o.matrixTransform(e.getScreenCTM().inverse());if(null!==v){var i=1e3,l=null,s=null;r.forEach((function(e,t){if(e.type===F){var n=Math.abs(e.pos-c.y);n<i&&n<20&&(l=e,s=t,i=n)}})),l&&(c.y=l.pos),i=1e3;var u=null,d=-1;r.forEach((function(e,t){if(e.type===J){var n=Math.abs(e.pos-c.x);n<i&&n<20&&(u=e,d=t,i=n)}})),u&&(c.x=u.pos);var h={type:a[v].type,anchorY:s,anchorX:d,x:c.x,y:c.y};t(Y({vertex:h,index:v}))}else if(null!==O){var p={x:c.x,y:c.y,index:O};t(L(p))}else console.error("weird")}},tabIndex:0,onKeyPress:function(e){var n=e.code;if("KeyC"===n)e.shiftKey&&(t(G()),t(P())),i("move");else if("KeyG"===n)U(),i("move");else if("KeyI"===n){var o=Object(u.a)(a);o.reverse(),t(I(o)),i("move")}else if("KeyR"===n){if(a.length){var r=a[0].x,c=a.map((function(e){var t=Object(s.a)({},e);return t.x=r-(e.x-r),t}));t(I(c))}i("move")}else"KeyM"===n?t(N()):i(ke[n])},children:[Object(h.jsx)("image",{href:w,height:"100%"}),Object(h.jsx)(te,{vertices:a,mirror:n.mirror}),Object(h.jsx)(q,{width:$,height:600,scale:n.scale}),Object(h.jsx)(Z,{width:$,height:600,onMouseDown:m}),Object(h.jsx)(p,{vertices:a,onMouseDown:b,onClick:function(e){if(c===we){var n=a[e],o=Object(s.a)({},n);o.type="control";o.x=n.x+50,o.y=n.y+50;var r=Object(u.a)(a);r.splice(e,0,o),t(I(r))}}})]})]})}var Se=function(){return Object(h.jsx)(Ee,{})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(g.a,{store:se,children:Object(h.jsx)(Se,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[87,1,2]]]);
//# sourceMappingURL=main.75a7af19.chunk.js.map